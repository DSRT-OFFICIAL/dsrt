<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cube Kuning dengan Lantai Grid dan Bayangan</title>
  <style>
    body {
      margin: 0;
      background: white;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    canvas {
      background: white;
    }
  </style>
</head>
<body>
<canvas id="cubeCanvas" width="800" height="600"></canvas>

<script>
const canvas = document.getElementById("cubeCanvas");
const ctx = canvas.getContext("2d");

const size = 100; // skala cube
const vertices = [
  [-1, -1, -1], [1, -1, -1],
  [1,  1, -1], [-1, 1, -1],
  [-1, -1,  1], [1, -1,  1],
  [1,  1,  1], [-1, 1,  1]
];

const edges = [
  [0,1],[1,2],[2,3],[3,0],
  [4,5],[5,6],[6,7],[7,4],
  [0,4],[1,5],[2,6],[3,7]
];

const faces = [
  [0,1,2,3],[4,5,6,7],
  [0,1,5,4],[2,3,7,6],
  [1,2,6,5],[0,3,7,4]
];

let angle = 0;

function project([x, y, z]) {
  const fov = 300;
  const scale = fov / (fov + z);
  return [
    x * size * scale + canvas.width/2,
    -y * size * scale + canvas.height/2
  ];
}

function rotate([x, y, z], angle) {
  const cos = Math.cos(angle);
  const sin = Math.sin(angle);

  // rotasi Y
  let x1 = x * cos - z * sin;
  let z1 = x * sin + z * cos;

  // rotasi X
  let y1 = y * cos - z1 * sin;
  let z2 = y * sin + z1 * cos;

  return [x1, y1, z2];
}

// Grid lantai penuh di bawah cube
function drawGrid() {
  ctx.strokeStyle = "#ccc";
  ctx.lineWidth = 1;

  const gridStep = 2;    // jarak antar garis kotak
  const gridRange = 20;  // jangkauan grid
  const floorY = -2;     // posisi lantai di bawah cube

  for (let x = -gridRange; x <= gridRange; x += gridStep) {
    ctx.beginPath();
    const p1 = project([x, floorY, -gridRange]);
    const p2 = project([x, floorY, gridRange]);
    ctx.moveTo(...p1);
    ctx.lineTo(...p2);
    ctx.stroke();
  }

  for (let z = -gridRange; z <= gridRange; z += gridStep) {
    ctx.beginPath();
    const p1 = project([-gridRange, floorY, z]);
    const p2 = project([gridRange, floorY, z]);
    ctx.moveTo(...p1);
    ctx.lineTo(...p2);
    ctx.stroke();
  }
}

// Bayangan cube di lantai
function drawShadow(rotatedVertices) {
  const shadowY = -2; // lantai
  const shadowVertices = rotatedVertices.map(([x, y, z]) => [x, shadowY, z]);

  ctx.fillStyle = "rgba(0,0,0,0.3)";
  faces.forEach(face => {
    ctx.beginPath();
    face.forEach((vi, i) => {
      const [px, py] = project(shadowVertices[vi]);
      if (i === 0) ctx.moveTo(px, py);
      else ctx.lineTo(px, py);
    });
    ctx.closePath();
    ctx.fill();
  });
}

function drawCube() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  drawGrid();

  const rotated = vertices.map(v => rotate(v, angle));

  // Bayangan di lantai
  drawShadow(rotated);

  const projected = rotated.map(v => project(v));

  // Cube kuning transparan
  ctx.fillStyle = "#FFD700";
  ctx.globalAlpha = 0.9;
  faces.forEach(face => {
    ctx.beginPath();
    face.forEach((vi, i) => {
      const [px, py] = projected[vi];
      if (i === 0) ctx.moveTo(px, py);
      else ctx.lineTo(px, py);
    });
    ctx.closePath();
    ctx.fill();
  });
  ctx.globalAlpha = 1.0;

  // Garis tepi cube
  ctx.strokeStyle = "black";
  ctx.lineWidth = 1.5;
  edges.forEach(edge => {
    const [p1, p2] = edge.map(i => projected[i]);
    ctx.beginPath();
    ctx.moveTo(...p1);
    ctx.lineTo(...p2);
    ctx.stroke();
  });
}

function animate() {
  angle += 0.02;
  drawCube();
  requestAnimationFrame(animate);
}

animate();
</script>
</body>
</html>
